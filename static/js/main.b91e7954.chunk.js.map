{"version":3,"sources":["../node_modules/peerjs/dist sync","components/card.tsx","game/index.ts","communication/index.ts","components/gameconfigurator.tsx","App.tsx","serviceWorkerRegistration.ts","reportWebVitals.ts","index.tsx"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","Card","card","hidden","onClick","colorMap","red","yellow","blue","green","wild","style","backgroundColor","color","assignedColor","face","shuffle","array","i","length","j","Math","floor","random","temp","COLORS","NORMAL_FACES","SPECIAL_FACES","newDeck","concat","filter","n","map","c","flat","w","defaultConfig","numDecks","playerNames","startingHandSize","maxDraws","plusTwosStackWithFours","plusTwoSkip","plusFourSkip","unoPenalty","jumpIn","makeConfig","config","mod","a","b","newGame","gameConfig","deck","_","range","numPlayers","game","uuid","drop","discard","players","p","name","cards","take","direction","currentPlayer","currentDraws","currentPot","winner","undefined","unclaimedUno","includes","first","takeCard","d","updateGame","stack","amount","pos","slice","newStack","isValidPlay","topCard","playedCard","playerIndex","canStackPot","playCardFromHand","cardIndex","wildSelectedColor","player","hand","console","log","idx","nextPlayer","cardEffect","update","newDirection","offset","sendMessage","conn","message","Array","isArray","peer","send","JSON","stringify","forEach","GameConfigurator","readOnly","setGameConfig","useState","locked","setLocked","submited","setSubmited","type","default","description","configs","setConfigs","useEffect","DynamicInput","value","onChange","disabled","checked","Object","configName","target","toInteger","fromPairs","k","App","setLocalGame","colorPicker","setColorPicker","ready","setReady","sessionId","setSessionId","isHost","setIsHost","setName","connections","setConnections","peers","setPeers","setGame","useCallback","currentId","error","connection","on","data","msg","parse","off","className","display","flexDirection","justifyContent","width","padding","every","drawCard","sum","find","val","acceptPunishment","position","top","left","claimingPlayerIndex","claimUno","findIndex","alignItems","alignContent","margin","cursor","freshGame","placeholder","Peer","cs","connect","trim","Boolean","window","location","hostname","match","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","registration","unregister","catch"],"mappings":"sHAAA,SAASA,EAAoBC,GAC5B,IAAIC,EAAI,IAAIC,MAAM,uBAAyBF,EAAM,KAEjD,MADAC,EAAEE,KAAO,mBACHF,EAEPF,EAAoBK,KAAO,WAAa,MAAO,IAC/CL,EAAoBM,QAAUN,EAC9BO,EAAOC,QAAUR,EACjBA,EAAoBS,GAAK,I,wHCNZC,EAAO,SAAC,GAQd,IAPLC,EAOI,EAPJA,KAOI,IANJC,cAMI,SALJC,EAKI,EALJA,QAMMC,EAAW,CACfC,IAAK,MACLC,OAAQ,SACRC,KAAM,OACNC,MAAO,QACPC,KAAM,QAER,OAAOR,EACL,qBACEE,QAAS,SAACX,IACHU,GAAUC,GACbA,EAAQX,IAGZkB,MAAO,CACLC,gBAAiBT,EACb,WACe,SAAfD,EAAKW,OAAoBX,EAAKY,cAC9BT,EAASH,EAAKY,eACdT,EAASH,EAAKW,OAClBA,MAAO,SAZX,SAeE,+BAAOV,EAAS,QAAUD,EAAKa,SAGjC,8B,wBCxBG,SAASC,EAAQC,GACtB,IAAK,IAAIC,EAAID,EAAME,OAAS,EAAGD,EAAI,EAAGA,IAAK,CACzC,IAAME,EAAIC,KAAKC,MAAMD,KAAKE,UAAYL,EAAI,IACpCM,EAAOP,EAAMC,GACnBD,EAAMC,GAAKD,EAAMG,GACjBH,EAAMG,GAAKI,GAIR,IAAMC,EAAkB,CAAC,OAAQ,MAAO,QAAS,UAC3CC,EAAe,CAC1B,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,KACA,UACA,QAEWC,EAAgB,CAAC,KAAM,gBAEvBC,EAAwB,WACnC,MAAM,GAAN,mBACKF,EAAaG,OAAOH,EAAaI,QAAO,SAACC,GAAD,MAAa,MAANA,MAC/CC,KAAI,SAACD,GAAD,OAAON,EAAOO,KAAI,SAACC,GAAD,MAAQ,CAAEpB,MAAOoB,EAAGlB,KAAMgB,SAChDG,QAHL,YAIKP,EAAcE,OAAOF,EAAeA,EAAeA,GACnDK,KAAI,SAACG,GAAD,MAAQ,CAAEtB,MAAO,OAAQE,KAAMoB,SAIpCC,EAAwB,CAC5BC,SAAU,EACVC,YAAa,CAAC,WAAY,WAAY,WAAY,YAClDC,iBAAkB,EAClBC,SAAU,EACVC,wBAAwB,EACxBC,aAAa,EACbC,cAAc,EACdC,WAAY,EACZC,QAAQ,GAGGC,EAA6C,SAACC,GAAD,mBAAC,eACtDX,GACAW,IAGCC,EAAwC,SAACC,EAAGC,GAAJ,OAAYD,EAAIC,EAAKA,GAAKA,GAE3DC,EAA6C,WAAsB,IAArBC,EAAoB,uDAAP,GAChEL,EAASD,EAAWM,GACpBC,EAAeC,IAAEC,MAAMR,EAAOV,UAAUL,IAAIJ,GAASM,OAC3DlB,EAAQqC,GAyBR,IAxBA,IAAMG,EAAaT,EAAOT,YAAYnB,OAClCsC,EAAU,aACZzD,GAAI0D,cACJL,KAAMC,IAAEK,KAAKN,EAAMG,EAAaT,EAAOR,iBAAmB,GAC1DqB,QAAS,CAACP,EAAKG,EAAaT,EAAOR,mBACnCsB,QAASd,EAAOT,YAAYN,KAC1B,SAAC8B,EAAG5C,GAAJ,MACG,CACC6C,KAAMD,EACNE,MAAOV,IAAEW,KACPX,IAAEK,KAAKN,EAAMnC,EAAI6B,EAAOR,kBACxBQ,EAAOR,sBAIf2B,UAAW,UACXC,cAAe,EACfC,aAAc,EACdC,WAAY,GACZC,YAAQC,EACRC,kBAAcD,GACXxB,GAGEpB,EAAc8C,SAAd,oBAAuBnB,IAAEoB,MAAMjB,EAAKG,gBAApC,aAAuB,EAAuB7C,YAA9C,QAAsD,KAAK,CAAC,IAAD,MACxC4D,EAASlB,EAAKJ,MAD0B,mBACzDnD,EADyD,KACnD0B,EADmD,KAE1DgD,EAAC,sBAAOhD,GAAP,YAAmB6B,EAAKG,UAC/B5C,EAAQ4D,GACRnB,EAAOoB,EAAWpB,EAAM,CACtBG,QAAS1D,EACTmD,KAAMuB,IAIV,OAAOnB,GAWIkB,EAIW,SAACG,GAAgC,IAAzBC,EAAwB,uDAAf,EAAGC,EAAY,uDAAN,EAC1ChB,EAAQV,IAAE2B,MAAMH,EAAOE,EAAKA,EAAMD,GAClCG,EAAQ,sBAAO5B,IAAEW,KAAKa,EAAOE,IAArB,YAA8B1B,IAAEK,KAAKmB,EAAOE,EAAMD,KAEhE,MAAO,CAACG,EAAUlB,IAGPmB,EAKE,SAAC1B,EAAM2B,EAASC,EAAYC,GAA5B,OACZ7B,EAAKU,gBAAkBmB,IACpB7B,EAAKY,WAAWlD,OAAS,GACzBoE,EAAY9B,EAAM2B,EAASC,IAC1B5B,EAAKY,WAAWlD,QAAU,IACxBiE,EAAQrE,OAASsE,EAAWtE,MAC3BqE,EAAQvE,QAAUwE,EAAWxE,OACV,SAAlBuE,EAAQvE,OACPuE,EAAQtE,gBAAkBuE,EAAWxE,OAClB,SAArBwE,EAAWxE,SAClB4C,EAAKZ,QACJwC,EAAWtE,OAASqE,EAAQrE,MAC5BsE,EAAWxE,QAAUuE,EAAQvE,OAEpB0E,EAIE,SAAC9B,EAAM2B,EAASC,GAAhB,OACbD,EAAQrE,OAASsE,EAAWtE,MAC3B0C,EAAKhB,yBACe,OAAjB2C,EAAQrE,MACRqE,EAAQtE,gBAAkBuE,EAAWxE,OACjB,OAApBwE,EAAWtE,MACO,OAAjBqE,EAAQrE,MAAqC,OAApBsE,EAAWtE,OAE9ByE,EAKD,SAAC/B,EAAM6B,EAAaG,EAAWC,GACzC,IAAMC,EAASlC,EAAKI,QAAQyB,GADmC,EAEzCX,EAASgB,EAAO3B,MAAO,EAAGyB,GAFe,mBAExDG,EAFwD,KAElD5B,EAFkD,KAGzD9D,EAAOoD,IAAEoB,MAAMV,GACfoB,EAAU9B,IAAEoB,MAAMjB,EAAKG,SAC7B,OAAI1D,GAAQkF,GAAWD,EAAY1B,EAAM2B,EAASlF,EAAMoF,IACtDO,QAAQC,IAAI,oBACO,SAAf5F,EAAKW,QACPX,EAAKY,cAAL,OAAqB4E,QAArB,IAAqBA,IAAqB,SAErCb,EAAWpB,EAAD,YAAC,aAChBG,QAAQ,CAAE1D,GAAH,mBAAYuD,EAAKG,UACxBC,QAASJ,EAAKI,QAAQ7B,KAAI,SAAC8B,EAAGiC,GAAJ,OACxBA,IAAQT,EAAR,2BAA2BxB,GAA3B,IAA8BE,MAAO4B,IAAS9B,KAEhDQ,OAAwB,IAAhBsB,EAAKzE,OAAesC,EAAKI,QAAQyB,QAAef,EACxDC,aAA8B,IAAhBoB,EAAKzE,OAAemE,OAAcf,GAC7CyB,EAAWvC,EAAM,EAAG6B,IACpBW,EAAWxC,EAAMvD,EAAM0F,MAGvBnC,GAGIoB,EAA0D,SACrEpB,EACAyC,GAFqE,mBAAC,2BAG7DzC,GAASyC,GAHmD,IAG3ClG,GAAI0D,iBA0EnBuC,EAIQ,SAACxC,EAAMvD,EAAMoD,GAChC,OAAQpD,EAAKa,MACX,IAAK,OACH,OAAO,eACFiF,EAAWvC,EAAM,IAExB,IAAK,UACH,IAAM0C,EAtKI,YAsKyB1C,EAAKS,UAtKlB,WAAa,UAuKnC,OAAO,aACLA,UAAWiC,GACRH,EACDnB,EAAWpB,EAAM,CAAES,UAAWiC,IACN,IAAxB1C,EAAKI,QAAQ1C,OAAe,EAAI,IAGtC,IAAK,KACL,IAAK,KACH,MAAO,CACLkD,WAAW,GAAD,mBAAMZ,EAAKY,YAAX,CAAqC,OAAdnE,EAAKa,KAAgB,EAAI,KAE9D,QACE,MAAO,KAIAiF,EAIuC,SAClDvC,GADkD,IAElD2C,EAFkD,uDAEzC,EACTjC,EAHkD,uDAGlCV,EAAKU,cAH6B,MAI9C,CACJA,cAAenB,EACbmB,GAAoC,YAAnBV,EAAKS,UAA0B,GAAK,GAAKkC,EAC1D3C,EAAKI,QAAQ1C,QAEfiD,aAAc,I,iBCjTHiC,EAGD,SAACC,EAAMC,GAEjB,GADAV,QAAQC,IAAI,0BAA2BS,EAAS,WAAYD,IACxDE,MAAMC,QAAQH,GAOhB,OADAT,QAAQC,IAAR,oCAAkCQ,QAAlC,IAAkCA,OAAlC,EAAkCA,EAAMI,MAAQH,GAChD,OAAOD,QAAP,IAAOA,OAAP,EAAOA,EAAMK,KAAKC,KAAKC,UAAUN,IANjCD,EAAKQ,SAAQ,SAAC7E,GACZ4D,QAAQC,IAAR,6BAAkC7D,EAAEyE,MAAQH,GAC5CtE,EAAE0E,KAAKC,KAAKC,UAAUN,Q,OCafQ,EAAmB,SAAC,GAAwC,IAAtCC,EAAqC,EAArCA,SAAUC,EAA2B,EAA3BA,cAA2B,EAC1CC,oBAAS,GADiC,mBAC/DC,EAD+D,KACvDC,EADuD,OAEtCF,oBAAS,GAF6B,mBAE/DG,EAF+D,KAErDC,EAFqD,OAGxCJ,mBAC5B,CACE7E,SAAU,CACRkF,KAAM,SACNC,QAAS,EACTC,YAAa,8BAEflF,iBAAkB,CAChBgF,KAAM,SACNC,QAAS,EACTC,YAAa,wCAEfjF,SAAU,CACR+E,KAAM,SACNC,QAAS,EACTC,YACE,gFAEJhF,uBAAwB,CACtB8E,KAAM,UACNC,SAAS,EACTC,YAAa,mDAEf/E,YAAa,CACX6E,KAAM,UACNC,SAAS,EACTC,YAAa,mDAEf9E,aAAc,CACZ4E,KAAM,UACNC,SAAS,EACTC,YAAa,mDAEf7E,WAAY,CACV2E,KAAM,SACNC,QAAS,EACTC,YACE,qEAEJ5E,OAAQ,CACN0E,KAAM,UACNC,SAAS,EACTC,YACE,uGA9C8D,mBAG/DC,EAH+D,KAGtDC,EAHsD,KAmDtEC,qBAAU,WACRR,EAAUJ,GAAYK,KACrB,CAACL,EAAUK,IAEd,IAAMQ,EAAe,SAAC,GAUf,IATL9E,EASI,EATJA,OACAoE,EAQI,EARJA,OACAW,EAOI,EAPJA,MACAC,EAMI,EANJA,SAOA,OAAQhF,EAAOwE,MACb,IAAK,UACH,OACE,uBACES,SAAUb,EACVI,KAAK,WACLU,QAASH,EACTC,SAAUA,IAGhB,IAAK,SACH,OACE,uBACEC,SAAUb,EACVI,KAAK,SACLO,MAAOA,EACPC,SAAUA,IAGhB,IAAK,SACH,OACE,uBACEC,SAAUb,EACVI,KAAK,OACLO,MAAOA,EACPC,SAAUA,MAMpB,OACE,gCACGG,OAAOtI,KAAK8H,GAAS1F,KAAI,SAACmG,GACzB,IAAMpF,EAAS2E,EAAQS,GACvB,OACE,gCACE,+BAAOpF,EAAO0E,cACd,cAACI,EAAD,CACEV,OAAQA,EACRpE,OAAQA,EACR+E,MAAO/E,EAAOyE,QACdO,SAAU,SAACtI,GACW,WAAhBsD,EAAOwE,KACTI,GAAW,SAACD,GAAD,mBAAC,eACPA,GADM,kBAERS,EAFQ,YAAC,eAGLpF,GAHI,IAIPyE,QAAS/H,EAAE2I,OAAON,aAGG,WAAhB/E,EAAOwE,KAChBI,GAAW,SAACD,GAAD,mBAAC,eACPA,GADM,kBAERS,EAFQ,YAAC,eAGLpF,GAHI,IAIPyE,QAASa,oBAAU5I,EAAE2I,OAAON,cAIhCH,GAAW,SAACD,GAAD,mBAAC,eACPA,GADM,kBAERS,EAFQ,YAAC,eAGLpF,GAHI,IAIPyE,QAAS/H,EAAE2I,OAAOH,oBA5BpBE,MAqCd,wBACE/H,QAAS,WACPkH,GAAY,GACZL,EACE3D,IAAEgF,UACAJ,OAAOtI,KAAK8H,GAAS1F,KAAI,SAACuG,GAAD,MAAO,CAACA,EAAGb,EAAQa,GAAGf,eALvD,sBCmPSgB,MApYf,WAAgB,IAAD,EACgBtB,mBAAS/D,EAAQ,KADjC,mBACNM,EADM,KACAgF,EADA,OAEyBvB,wBAEpC3C,GAJW,mBAENmE,EAFM,KAEOC,EAFP,OAKazB,oBAAS,GALtB,mBAKN0B,EALM,KAKCC,EALD,OAMqB3B,mBAAS,IAN9B,mBAMN4B,EANM,KAMKC,EANL,OAOe7B,oBAAS,GAPxB,mBAON8B,EAPM,KAOEC,EAPF,OAQW/B,mBAAS,IARpB,mBAQNnD,EARM,KAQAmF,EARA,OASyBhC,mBAA2B,IATpD,mBASNiC,EATM,KASOC,EATP,OAUalC,mBAAmB,IAVhC,mBAUNmC,EAVM,KAUCC,EAVD,OAWuBpC,mBAAqB,IAX5C,mBAWN9D,EAXM,KAWM6D,EAXN,KAaPsC,EAAUC,uBACd,SAACrG,EAAesG,GACVA,IAAchG,EAAKzD,IACjBgJ,GACFP,EAAatF,GAEXsG,IAActG,EAAQnD,IACxBqG,EAAY8C,EAAa,CACvB5B,KAAM,aACN9D,KAAMN,EACNsG,eAIJ5D,QAAQ6D,MACN,uBACAvG,EAFF,mCAG8BsG,EAH9B,gCAG+DhG,EAAKzD,OAIxE,CAACmJ,EAAaH,EAAQvF,IAiExB,OA9DAmE,qBAAU,WACJuB,GAAeH,GACjBG,EAAYrC,SAAQ,SAAC6C,GAAD,OAClBtD,EAAYsD,EAAY,CAAEpC,KAAM,WAAY8B,eAG/C,CAACA,EAAOF,EAAaH,IAExBpB,qBAAU,WACR/B,QAAQC,IAAI,yBAA0BuD,KACrC,CAACA,IAEJzB,qBAAU,WACR/B,QAAQC,IAAI,gCAAiCqD,KAC5C,CAACA,IAEJvB,qBAAU,WAsCR,OArCAuB,EAAYrC,SAAQ,SAACR,GACnBA,EAAKsD,GAAG,QAAQ,SAACC,GACf,IFvD+CtD,EEuDzCuD,GFvDyCvD,EEuDdsD,EFtDvCjD,KAAKmD,MAAMxD,IEwDL,OADAV,QAAQC,IAAI,WAAYgE,GAChBA,EAAIvC,MACV,IAAK,UACH+B,GAAS,SAACxF,GAER,OADA+B,QAAQC,IAAR,uBAA4BgE,EAAIpD,KAAhC,aAAiD5C,GAC3C,GAAN,mBAAWA,GAAX,CAAcgG,EAAIpD,UAEpB,MACF,IAAK,WACH4C,EAASQ,EAAIT,OACb,MACF,IAAK,aACCL,EACFO,EAAQO,EAAIrG,KAAMqG,EAAIL,WAEtBhB,EAAaqB,EAAIrG,MAEnBoF,GAAS,OAOfvC,EAAKsD,GAAG,QAAQ,WACd/D,QAAQC,IAAI,oBACPkD,GACH3C,EAAYC,EAAM,CAChBiB,KAAM,UACNb,KAAM3C,UAKP,WACLoF,EAAYrC,SAAQ,SAACR,GACnBA,EAAK0D,IAAI,YAASzF,GAClB+B,EAAK0D,IAAI,YAASzF,SAGrB,CAAC4E,EAAaH,EAAQjF,EAAMwF,IAG7B,qBAAKU,UAAU,MAAf,SACE,wBAAQA,UAAU,aAAlB,SACIrB,EAqGA,mCACGnF,EAAKa,OACJ,qCACE,+DAAkCb,EAAKa,OAAOP,QAC7CiF,GACC,wBACE5I,QAAS,WACPmJ,EACEpG,EAAQ,2BAAKC,GAAN,IAAkBd,YAAa+G,KACtC5F,EAAKzD,IAEP6I,GAAS,IANb,6BAcJ,qCACE,sBAAKlI,MAAO,CAAEuJ,QAAS,OAAQC,cAAe,UAA9C,UACE,4CACC,cAAC,EAAD,CAAMjK,KAAMoD,IAAEoB,MAAMjB,EAAKG,cAE5B,qBAAKjD,MAAO,CAAEuJ,QAAS,OAAQC,cAAe,UAA9C,SACE,2CAAc1G,EAAKJ,KAAKlC,OAAxB,cAEDuH,GACC,8BACGjH,EAAOO,KAAI,SAACnB,GAAD,OACV,wBACEF,MAAO,CAAEC,gBAAiBC,GAE1BT,QAAS,WACPmJ,EAAQb,EAAY7H,GAAQ4C,EAAKzD,IACjC2I,OAAepE,IALnB,SAQG1D,GANIA,QAWb,qBACEb,GAAG,eACHW,MAAO,CACLuJ,QAAS,OACTE,eAAgB,gBAChBC,MAAO,OALX,SAQG5G,EAAKI,QAAQ7B,KAAI,SAAC2D,EAAQL,GAAT,OAChB,sBAEE3E,MAAO,CACLuJ,QAAS,OACTC,cAAe,SACfG,QAAS,OALb,UAQE,sBACE3J,MAAO,CACLE,MACE4C,EAAKU,gBAAkBmB,EACnB,QACA,SALV,SAQGK,EAAO5B,OAEV,iCAAO4B,EAAO3B,MAAM7C,OAApB,YACCwE,EAAO5B,OAASA,IACa,IAA3BN,EAAKY,WAAWlD,QACjBsC,EAAKU,gBAAkBmB,EACrB,wBACE0C,SAAUvE,EAAKU,gBAAkBmB,EACjClF,QAAS,WACHuF,EAAO5B,OAASA,GAClBwF,EHrFmC,SACjE9F,EACA6B,GAEA,GAAI7B,EAAKU,gBAAkBmB,EAAa,OAAO7B,EAD5C,MAEmBkB,EAASlB,EAAKJ,MAFjC,mBAEIA,EAFJ,KAEUW,EAFV,KAGH,GAAIA,EAAM7C,OAAS,EAAG,CACpB,IAAMgC,EAAU0B,EAAWpB,EAAM,CAC/BJ,OACAQ,QAASJ,EAAKI,QAAQ7B,KAAI,SAAC8B,EAAG5C,GAAJ,OACxBA,IAAMoE,EAAN,2BAAyBxB,GAAzB,IAA4BE,MAAM,GAAD,mBAAMF,EAAEE,OAAR,YAAkBA,MAAWF,KAEhEM,aAAcX,EAAKW,aAAe,IAE9BgB,EAAU9B,IAAEoB,MAAMjB,EAAKG,SAC7B,OACEH,EAAKjB,UAAY,GACjBW,EAAQiB,cAAgBX,EAAKjB,UAC7BW,EAAQU,QAAQyB,GAAatB,MAAMuG,OACjC,SAACrK,GAAD,OAAUkF,IAAYD,EAAY1B,EAAM2B,EAASlF,EAAMoF,MAGlDT,EAAW1B,EAAS6C,EAAWvC,IAE/BN,EAGX,OAAOM,EG0D+B+G,CAAS/G,EAAM6B,GAAc7B,EAAKzD,KAJhD,uBAUA,yBACEI,QAAS,WACHuF,EAAO5B,OAASA,GAClBwF,EHhE2C,SACzE9F,EACA6B,GACI,IAAD,EACmBX,EAASlB,EAAKJ,KAAMC,IAAEmH,IAAIhH,EAAKY,YAAa,GAD/D,mBACIhB,EADJ,KACUW,EADV,KAEH,OAAOa,EAAWpB,EAAD,aACfJ,OACAQ,QAASJ,EAAKI,QAAQ7B,KAAI,SAAC8B,EAAG5C,GAC5B,OAAIA,IAAMoE,EACD,2BAAKxB,GAAZ,IAAeE,MAAM,GAAD,mBAAMF,EAAEE,OAAR,YAAkBA,MAE/BF,KAGXO,WAAY,IACPZ,EAAKd,cAAgBc,EAAKY,WAAWqG,MAAK,SAACC,GAAD,OAAiB,IAARA,MACvDlH,EAAKf,aAAee,EAAKY,WAAWqG,MAAK,SAACC,GAAD,OAAiB,IAARA,KAC/C3E,EAAWvC,GACX,KG+C0BmH,CAAiBnH,EAAM6B,GACvB7B,EAAKzD,KALb,iCASuBsD,IAAEmH,IAAIhH,EAAKY,YATlC,aAYmBE,IAAtBd,EAAKe,cACNmB,EAAO5B,OAASA,EACd,qBACEpD,MACE8C,EAAKI,QAAQJ,EAAKe,cAAcT,OAASA,EACrC,GACA,CACE8G,SAAU,WACVC,IAAI,GAAD,OAAK,GAAKzJ,KAAKE,SAAf,KACHwJ,KAAK,GAAD,OAAK,GAAK1J,KAAKE,SAAf,MAPd,SAWE,yBACEnB,QAAS,WACPmJ,EH1IqC,SACjE9F,EACAuH,GAEA,QAA0BzG,IAAtBd,EAAKe,aAA4B,OAAOf,EADzC,MAGmBkB,EAASlB,EAAKJ,KAAMI,EAAKb,YAH5C,mBAGIS,EAHJ,KAGUW,EAHV,KAIH,OAAOP,EAAKe,eAAiBwG,EACzBnG,EAAWpB,EAAM,CACfJ,OACAQ,QAASJ,EAAKI,QAAQ7B,KAAI,SAAC8B,EAAG5C,GAAJ,OACxBA,IAAMuC,EAAKe,aAAX,2BAA+BV,GAA/B,IAAkCE,MAAM,GAAD,mBAAMF,EAAEE,OAAR,YAAkBA,MAAWF,KAEtEU,kBAAcD,IAEhBM,EAAWpB,EAAM,CACfe,kBAAcD,IG2HU0G,CACExH,EACAA,EAAKI,QAAQqH,WAAU,SAACpH,GAAD,OAAOA,EAAEC,OAASA,MAE3CN,EAAKzD,KAPX,UAWGyD,EAAKI,QAAQJ,EAAKe,cAAcT,OAASA,EACtC,QACA,UAAW,IAbjB,YAkBF,6BAEF,qBACEpD,MAAO,CACLuJ,QAAS,OACTC,cAAe,SACfE,MAAO,OACPc,WAAY,UACZC,aAAc,UACdhB,eAAgB,iBAPpB,SAUGzE,EAAO3B,MAAMhC,KAAI,SAACC,EAAGf,GAAJ,OAChB,qBAEEP,MAAO,CACL0K,OAAQ,MACRC,OACE3F,EAAO5B,OAASA,EAAO,UAAY,WALzC,SAQE,cAAC,EAAD,CACE5D,OAAQwF,EAAO5B,OAASA,EAExB3D,QAAS,WACS,SAAZ6B,EAAEpB,MACJ8H,GAAe,kBAAM,SAAC9H,GACpB,OAAO2E,EACL/B,EACA6B,EACApE,EACAL,OAIJ0I,EACE/D,EAAiB/B,EAAM6B,EAAapE,GACpCuC,EAAKzD,KAIXE,KAAM+B,GAlBDf,IATFA,UAxFNyE,EAAO5B,gBAzJxB,qCACGiF,EACC,gCACE,wBACE5I,QAAS,WACP,IAAMmL,EAAYpI,EAAQ,2BACrBC,GADoB,IAEvBd,YAAa+G,KAEfE,EAAQgC,EAAW9H,EAAKzD,IACxB6I,GAAS,IAPb,wBAYA,cAAC,EAAD,CACE7B,UAAU,EACVC,cAAeA,QAIT,KAATlD,GAA6B,KAAd+E,IACd,mEAGJ,8BACE,6BACGO,EAAMrH,KAAI,SAAC8B,GAAD,OACT,6BAAaA,GAAJA,UAIf,8BACE,uBACEyD,KAAK,OACLiE,YAAY,OACZxD,SACEmB,EAAYhI,OAAS,GAAKkI,EAAMlI,OAAS,EAE3C4G,SAAU,SAACtI,GAAD,OAAOyJ,EAAQzJ,EAAE2I,OAAON,QAClCA,MAAO/D,MAGX,uBACCiF,GACC,8BACE,oFACmDF,QAIrDE,GAAiC,IAAvBG,EAAYhI,QACtB,qCACE,8BACE,wBACE6G,SAAmB,KAATjE,EACV3D,QAAS,WACP,IAAMsG,EAAO,IAAI+E,IACjB/E,EAAKkD,GAAG,QAAQ,SAAC5J,GACf6F,QAAQC,IAAI,uBAAwB9F,GACpCiJ,GAAU,GACVK,EAAS,CAACvF,IACVgF,EAAa/I,GACb0G,EAAKkD,GAAG,cAAc,SAACtD,GACrBT,QAAQC,IAAI,uBAAwBQ,GACpC8C,GAAe,SAACsC,GAAD,4BAAYA,GAAZ,CAAgBpF,cAXvC,8BAmBF,sCACA,gCACE,uBACEiB,KAAK,OACLiE,YAAY,aACZ1D,MAAOgB,EACPf,SAAU,SAACtI,GAAD,OAAOsJ,EAAatJ,EAAE2I,OAAON,UAEzC,wBACEE,SAAwB,KAAdc,GAA6B,KAAT/E,EAC9B3D,QAAS,WACPyF,QAAQC,IAAI,uBAAwBgD,GACpC,IAAMpC,EAAO,IAAI+E,IACjB/E,EAAKkD,GAAG,QAAQ,SAAC5J,GACf6F,QAAQC,IAAI,YAAa9F,GACzB,IAAMsG,EAAOI,EAAKiF,QAAQ7C,EAAU8C,QACpCxC,GAAe,SAACsC,GAAD,4BAAYA,GAAZ,CAAgBpF,WARrC,0CC9LEuF,QACW,cAA7BC,OAAOC,SAASC,UAEe,UAA7BF,OAAOC,SAASC,UAEhBF,OAAOC,SAASC,SAASC,MAAM,2DCfnC,IAYeC,EAZS,SAACC,GACnBA,GAAeA,aAAuBC,UACxC,6BAAqBC,MAAK,YAAkD,IAA/CC,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAON,GACPO,EAAQP,OCFdQ,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,SFyHpB,kBAAmBC,WACrBA,UAAUC,cAAcrE,MACrByD,MAAK,SAACa,GACLA,EAAaC,gBAEdC,OAAM,SAAC1D,GACN7D,QAAQ6D,MAAMA,EAAMnD,YEpH5B2F,M","file":"static/js/main.b91e7954.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 21;","import { Card as GameCard } from \"../game/types\";\n\nexport const Card = ({\n  card,\n  hidden = false,\n  onClick,\n}: {\n  hidden?: boolean;\n  card?: GameCard;\n  onClick?: React.MouseEventHandler<HTMLDivElement>;\n}) => {\n  const colorMap = {\n    red: \"red\",\n    yellow: \"orange\",\n    blue: \"aqua\",\n    green: \"green\",\n    wild: \"gray\",\n  };\n  return card ? (\n    <div\n      onClick={(e) => {\n        if (!hidden && onClick) {\n          onClick(e);\n        }\n      }}\n      style={{\n        backgroundColor: hidden\n          ? \"darkgray\"\n          : card.color === \"wild\" && card.assignedColor\n          ? colorMap[card.assignedColor]\n          : colorMap[card.color],\n        color: \"black\",\n      }}\n    >\n      <span>{hidden ? \"<uno>\" : card.face}</span>\n    </div>\n  ) : (\n    <></>\n  );\n};\n","import {\n  Card,\n  Game,\n  GameConfig,\n  Config,\n  Player,\n  Direction,\n  Color,\n} from \"./types\";\nimport _ from \"lodash\";\nimport { v4 as uuid } from \"uuid\";\n\n/* Randomize array in-place using Durstenfeld shuffle algorithm */\nexport function shuffle(array: any[]) {\n  for (let i = array.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    const temp = array[i];\n    array[i] = array[j];\n    array[j] = temp;\n  }\n}\n\nexport const COLORS: Color[] = [\"blue\", \"red\", \"green\", \"yellow\"];\nexport const NORMAL_FACES = [\n  \"0\",\n  \"1\",\n  \"2\",\n  \"3\",\n  \"4\",\n  \"5\",\n  \"6\",\n  \"7\",\n  \"8\",\n  \"9\",\n  \"+2\",\n  \"reverse\",\n  \"skip\",\n];\nexport const SPECIAL_FACES = [\"+4\", \"change_color\"];\n\nexport const newDeck: () => Card[] = () => {\n  return [\n    ...NORMAL_FACES.concat(NORMAL_FACES.filter((n) => n !== \"0\")) // two of each number card except for 0\n      .map((n) => COLORS.map((c) => ({ color: c, face: n } as Card))) // each with one of the four colors\n      .flat(),\n    ...SPECIAL_FACES.concat(SPECIAL_FACES, SPECIAL_FACES, SPECIAL_FACES) // four of each wild cards\n      .map((w) => ({ color: \"wild\", face: w } as Card)),\n  ];\n};\n\nconst defaultConfig: Config = {\n  numDecks: 1,\n  playerNames: [\"player 1\", \"player 2\", \"player 3\", \"player 4\"],\n  startingHandSize: 7,\n  maxDraws: 1,\n  plusTwosStackWithFours: true,\n  plusTwoSkip: false,\n  plusFourSkip: true,\n  unoPenalty: 5,\n  jumpIn: false,\n};\n\nexport const makeConfig: (config: GameConfig) => Config = (config) => ({\n  ...defaultConfig,\n  ...config,\n});\n\nconst mod: (a: number, b: number) => number = (a, b) => ((a % b) + b) % b;\n\nexport const newGame: (gameConfig?: GameConfig) => Game = (gameConfig = {}) => {\n  const config = makeConfig(gameConfig);\n  const deck: Card[] = _.range(config.numDecks).map(newDeck).flat();\n  shuffle(deck);\n  const numPlayers = config.playerNames.length;\n  let game: Game = {\n    id: uuid(),\n    deck: _.drop(deck, numPlayers * config.startingHandSize + 1),\n    discard: [deck[numPlayers * config.startingHandSize]],\n    players: config.playerNames.map(\n      (p, i) =>\n        ({\n          name: p,\n          cards: _.take(\n            _.drop(deck, i * config.startingHandSize),\n            config.startingHandSize\n          ),\n        } as Player)\n    ),\n    direction: \"forward\",\n    currentPlayer: 0,\n    currentDraws: 0,\n    currentPot: [],\n    winner: undefined,\n    unclaimedUno: undefined,\n    ...config,\n  };\n\n  while (SPECIAL_FACES.includes(_.first(game.discard)?.face ?? \"\")) {\n    const [card, newDeck] = takeCard(game.deck);\n    const d = [...newDeck, ...game.discard];\n    shuffle(d);\n    game = updateGame(game, {\n      discard: card,\n      deck: d,\n    });\n  }\n\n  return game;\n};\n\nexport const flipDirection: (direction: Direction) => Direction = (direction) =>\n  direction === \"forward\" ? \"backward\" : \"forward\";\n\n/**\n * @returns A tuple containing:\n *   - the new stack of cards without the taken ones\n *   - the taken cards\n */\nexport const takeCard: (\n  stack: Card[],\n  amount?: number,\n  pos?: number\n) => [Card[], Card[]] = (stack, amount = 1, pos = 0) => {\n  const cards = _.slice(stack, pos, pos + amount);\n  const newStack = [..._.take(stack, pos), ..._.drop(stack, pos + amount)];\n\n  return [newStack, cards];\n};\n\nexport const isValidPlay: (\n  game: Game,\n  topCard: Card,\n  playedCard: Card,\n  playerIndex: number\n) => boolean = (game, topCard, playedCard, playerIndex) =>\n  (game.currentPlayer === playerIndex &&\n    ((game.currentPot.length > 0 && // there is a pot, so only reactions are valid\n      canStackPot(game, topCard, playedCard)) ||\n      (game.currentPot.length <= 0 && // there is no pot, any card is valid\n        (topCard.face === playedCard.face ||\n          topCard.color === playedCard.color ||\n          (topCard.color === \"wild\" && // topCard is a wildcard, use its assignedColor\n            topCard.assignedColor === playedCard.color) ||\n          playedCard.color === \"wild\")))) || // wild cards can always be played\n  (game.jumpIn &&\n    playedCard.face === topCard.face &&\n    playedCard.color === topCard.color);\n\nexport const canStackPot: (\n  game: Game,\n  topCard: Card,\n  playedCard: Card\n) => boolean = (game, topCard, playedCard) =>\n  topCard.face === playedCard.face || // can always stack +4 on +4 or +2 on +2\n  (game.plusTwosStackWithFours &&\n    ((topCard.face === \"+4\" &&\n      topCard.assignedColor === playedCard.color &&\n      playedCard.face === \"+2\") || // on top of a +4, only a +2 of the same color is valid\n      (topCard.face === \"+2\" && playedCard.face === \"+4\"))); // on top of a +2, a +4 is valid\n\nexport const playCardFromHand: (\n  game: Game,\n  playerIndex: number,\n  cardIndex: number,\n  wildSelectedColor?: Color\n) => Game = (game, playerIndex, cardIndex, wildSelectedColor) => {\n  const player = game.players[playerIndex];\n  const [hand, cards] = takeCard(player.cards, 1, cardIndex);\n  const card = _.first(cards);\n  const topCard = _.first(game.discard);\n  if (card && topCard && isValidPlay(game, topCard, card, playerIndex)) {\n    console.log(\"I can play this!\");\n    if (card.color === \"wild\") {\n      card.assignedColor = wildSelectedColor ?? \"green\";\n    }\n    return updateGame(game, {\n      discard: [card, ...game.discard],\n      players: game.players.map((p, idx) =>\n        idx === playerIndex ? { ...p, cards: hand } : p\n      ),\n      winner: hand.length === 0 ? game.players[playerIndex] : undefined,\n      unclaimedUno: hand.length === 1 ? playerIndex : undefined,\n      ...nextPlayer(game, 1, playerIndex),\n      ...cardEffect(game, card, hand),\n    });\n  }\n  return game;\n};\n\nexport const updateGame: (game: Game, update: Partial<Game>) => Game = (\n  game,\n  update\n) => ({ ...game, ...update, id: uuid() });\n\nexport const claimUno: (game: Game, playerIndex: number) => Game = (\n  game,\n  claimingPlayerIndex\n) => {\n  if (game.unclaimedUno === undefined) return game;\n\n  const [deck, cards] = takeCard(game.deck, game.unoPenalty);\n  return game.unclaimedUno !== claimingPlayerIndex\n    ? updateGame(game, {\n        deck,\n        players: game.players.map((p, i) =>\n          i === game.unclaimedUno ? { ...p, cards: [...p.cards, ...cards] } : p\n        ),\n        unclaimedUno: undefined,\n      })\n    : updateGame(game, {\n        unclaimedUno: undefined,\n      });\n};\n\nexport const drawCard: (game: Game, playerIndex: number) => Game = (\n  game,\n  playerIndex\n) => {\n  if (game.currentPlayer !== playerIndex) return game;\n  const [deck, cards] = takeCard(game.deck);\n  if (cards.length > 0) {\n    const newGame = updateGame(game, {\n      deck,\n      players: game.players.map((p, i) =>\n        i === playerIndex ? { ...p, cards: [...p.cards, ...cards] } : p\n      ),\n      currentDraws: game.currentDraws + 1,\n    });\n    const topCard = _.first(game.discard);\n    if (\n      game.maxDraws >= 1 &&\n      newGame.currentDraws >= game.maxDraws &&\n      newGame.players[playerIndex].cards.every(\n        (card) => topCard && !isValidPlay(game, topCard, card, playerIndex)\n      )\n    ) {\n      return updateGame(newGame, nextPlayer(game));\n    } else {\n      return newGame;\n    }\n  }\n  return game;\n};\n\nexport const acceptPunishment: (game: Game, playerIndex: number) => Game = (\n  game,\n  playerIndex\n) => {\n  const [deck, cards] = takeCard(game.deck, _.sum(game.currentPot), 0);\n  return updateGame(game, {\n    deck,\n    players: game.players.map((p, i) => {\n      if (i === playerIndex) {\n        return { ...p, cards: [...p.cards, ...cards] };\n      } else {\n        return p;\n      }\n    }),\n    currentPot: [],\n    ...((game.plusFourSkip && game.currentPot.find((val) => val === 4)) ||\n    (game.plusTwoSkip && game.currentPot.find((val) => val === 2))\n      ? nextPlayer(game)\n      : {}),\n  });\n};\n\nexport const cardEffect: (\n  game: Game,\n  card: Card,\n  afterHand: Card[]\n) => Partial<Game> = (game, card, _) => {\n  switch (card.face) {\n    case \"skip\":\n      return {\n        ...nextPlayer(game, 2),\n      };\n    case \"reverse\":\n      const newDirection = flipDirection(game.direction);\n      return {\n        direction: newDirection,\n        ...nextPlayer(\n          updateGame(game, { direction: newDirection }),\n          game.players.length === 2 ? 2 : 1\n        ),\n      };\n    case \"+4\":\n    case \"+2\":\n      return {\n        currentPot: [...game.currentPot, card.face === \"+2\" ? 2 : 4],\n      };\n    default:\n      return {};\n  }\n};\n\nexport const nextPlayer: (\n  game: Game,\n  offset?: number,\n  currentPlayer?: number\n) => Pick<Game, \"currentPlayer\" | \"currentDraws\"> = (\n  game,\n  offset = 1,\n  currentPlayer = game.currentPlayer\n) => ({\n  currentPlayer: mod(\n    currentPlayer + (game.direction === \"forward\" ? 1 : -1) * offset,\n    game.players.length\n  ),\n  currentDraws: 0,\n});\n","import { Message } from \"./types\";\nimport Peer from \"peerjs\";\n\nexport const sendMessage: (\n  conn: Peer.DataConnection | Peer.DataConnection[] | undefined,\n  message: Message\n) => void = (conn, message) => {\n  console.log(\"was tasked to send msg:\", message, \"to conn:\", conn);\n  if (Array.isArray(conn)) {\n    conn.forEach((c) => {\n      console.log(`Sending message to ${c.peer}`, message);\n      c.send(JSON.stringify(message));\n    });\n  } else {\n    console.log(`Sending message to ${conn?.peer}`, message);\n    return conn?.send(JSON.stringify(message));\n  }\n};\n\nexport const recvMessage: (message: any) => Message = (message) =>\n  JSON.parse(message) as Message;\n","import _, { toInteger } from \"lodash\";\nimport { useEffect, useState } from \"react\";\nimport { GameConfig } from \"../game/types\";\n\ntype Props = {\n  setGameConfig: (config: GameConfig) => void;\n  readOnly: boolean;\n};\n\ntype ConfigEntry = (\n  | {\n      type: \"number\";\n      default: number;\n    }\n  | {\n      type: \"string\";\n      default: string;\n    }\n  | {\n      type: \"boolean\";\n      default: boolean;\n    }\n) & { description: string };\n\nexport const GameConfigurator = ({ readOnly, setGameConfig }: Props) => {\n  const [locked, setLocked] = useState(false);\n  const [submited, setSubmited] = useState(false);\n  const [configs, setConfigs] = useState<{ [configName: string]: ConfigEntry }>(\n    {\n      numDecks: {\n        type: \"number\",\n        default: 1,\n        description: \"Number of UNO decks to use\",\n      },\n      startingHandSize: {\n        type: \"number\",\n        default: 7,\n        description: \"Number of cards in the starting hand\",\n      },\n      maxDraws: {\n        type: \"number\",\n        default: 1,\n        description:\n          \"Amount of card draws one can make before skipping their turn. 0 for infinite\",\n      },\n      plusTwosStackWithFours: {\n        type: \"boolean\",\n        default: false,\n        description: \"Wether a +2 be stacked with a +4 and vice-versa\",\n      },\n      plusTwoSkip: {\n        type: \"boolean\",\n        default: false,\n        description: \"Wether playing a +2 will skip the victim's turn\",\n      },\n      plusFourSkip: {\n        type: \"boolean\",\n        default: true,\n        description: \"Wether playing a +4 will skip the victim's turn\",\n      },\n      unoPenalty: {\n        type: \"number\",\n        default: 5,\n        description:\n          \"The amount of cards used to penalize who doesn't call UNO on time\",\n      },\n      jumpIn: {\n        type: \"boolean\",\n        default: false,\n        description:\n          \"Wether a player can jump in front of other when they have the exact same card that is in the pile\",\n      },\n    }\n  );\n\n  useEffect(() => {\n    setLocked(readOnly || submited);\n  }, [readOnly, submited]);\n\n  const DynamicInput = ({\n    config,\n    locked,\n    value,\n    onChange,\n  }: {\n    config: ConfigEntry;\n    locked: boolean;\n    value: string | number | boolean;\n    onChange: React.ChangeEventHandler<HTMLInputElement>;\n  }) => {\n    switch (config.type) {\n      case \"boolean\":\n        return (\n          <input\n            disabled={locked}\n            type=\"checkbox\"\n            checked={value as boolean}\n            onChange={onChange}\n          />\n        );\n      case \"number\":\n        return (\n          <input\n            disabled={locked}\n            type=\"number\"\n            value={value as number}\n            onChange={onChange}\n          />\n        );\n      case \"string\":\n        return (\n          <input\n            disabled={locked}\n            type=\"text\"\n            value={value as string}\n            onChange={onChange}\n          />\n        );\n    }\n  };\n\n  return (\n    <div>\n      {Object.keys(configs).map((configName) => {\n        const config = configs[configName];\n        return (\n          <div key={configName}>\n            <span>{config.description}</span>\n            <DynamicInput\n              locked={locked}\n              config={config}\n              value={config.default}\n              onChange={(e) => {\n                if (config.type === \"string\") {\n                  setConfigs((configs) => ({\n                    ...configs,\n                    [configName]: {\n                      ...config,\n                      default: e.target.value,\n                    },\n                  }));\n                } else if (config.type === \"number\") {\n                  setConfigs((configs) => ({\n                    ...configs,\n                    [configName]: {\n                      ...config,\n                      default: toInteger(e.target.value),\n                    },\n                  }));\n                } else {\n                  setConfigs((configs) => ({\n                    ...configs,\n                    [configName]: {\n                      ...config,\n                      default: e.target.checked,\n                    },\n                  }));\n                }\n              }}\n            />\n          </div>\n        );\n      })}\n      <button\n        onClick={() => {\n          setSubmited(true);\n          setGameConfig(\n            _.fromPairs(\n              Object.keys(configs).map((k) => [k, configs[k].default])\n            )\n          );\n        }}\n      >\n        Save\n      </button>\n    </div>\n  );\n};\n","import { useCallback, useEffect, useState } from \"react\";\nimport \"./App.css\";\nimport { Card } from \"./components/card\";\nimport {\n  acceptPunishment,\n  claimUno,\n  COLORS,\n  drawCard,\n  newGame,\n  playCardFromHand,\n} from \"./game\";\nimport _ from \"lodash\";\nimport { Color, Game, GameConfig } from \"./game/types\";\nimport Peer, { DataConnection } from \"peerjs\";\nimport { Message } from \"./communication/types\";\nimport { recvMessage, sendMessage } from \"./communication\";\nimport { GameConfigurator } from \"./components/gameconfigurator\";\n\nfunction App() {\n  const [game, setLocalGame] = useState(newGame({}));\n  const [colorPicker, setColorPicker] = useState<\n    ((color: Color) => Game) | undefined\n  >(undefined);\n  const [ready, setReady] = useState(false);\n  const [sessionId, setSessionId] = useState(\"\");\n  const [isHost, setIsHost] = useState(false);\n  const [name, setName] = useState(\"\");\n  const [connections, setConnections] = useState<DataConnection[]>([]);\n  const [peers, setPeers] = useState<string[]>([]);\n  const [gameConfig, setGameConfig] = useState<GameConfig>({});\n\n  const setGame = useCallback(\n    (newGame: Game, currentId: string) => {\n      if (currentId === game.id) {\n        if (isHost) {\n          setLocalGame(newGame);\n        }\n        if (currentId !== newGame.id) {\n          sendMessage(connections, {\n            type: \"updategame\",\n            game: newGame,\n            currentId,\n          });\n        }\n      } else {\n        console.error(\n          \"Ignoring game update\",\n          newGame,\n          `meant for an old version ${currentId}. current version is ${game.id}`\n        );\n      }\n    },\n    [connections, isHost, game]\n  );\n\n  useEffect(() => {\n    if (connections && isHost) {\n      connections.forEach((connection) =>\n        sendMessage(connection, { type: \"peerlist\", peers })\n      );\n    }\n  }, [peers, connections, isHost]);\n\n  useEffect(() => {\n    console.log(\"Peer list got updated!\", peers);\n  }, [peers]);\n\n  useEffect(() => {\n    console.log(\"Connections list got updated!\", connections);\n  }, [connections]);\n\n  useEffect(() => {\n    connections.forEach((conn) => {\n      conn.on(\"data\", (data) => {\n        const msg: Message = recvMessage(data);\n        console.log(\"Got data\", msg);\n        switch (msg.type) {\n          case \"newpeer\":\n            setPeers((p) => {\n              console.log(`Got new peer ${msg.peer}. Current`, p);\n              return [...p, msg.peer];\n            });\n            break;\n          case \"peerlist\":\n            setPeers(msg.peers);\n            break;\n          case \"updategame\":\n            if (isHost) {\n              setGame(msg.game, msg.currentId);\n            } else {\n              setLocalGame(msg.game);\n            }\n            setReady(true);\n            break;\n          default:\n            break;\n        }\n      });\n\n      conn.on(\"open\", () => {\n        console.log(\"Opened new conn!\");\n        if (!isHost)\n          sendMessage(conn, {\n            type: \"newpeer\",\n            peer: name,\n          });\n      });\n    });\n\n    return () => {\n      connections.forEach((conn) => {\n        conn.off(\"data\", (undefined as unknown) as Function);\n        conn.off(\"open\", (undefined as unknown) as Function);\n      });\n    };\n  }, [connections, isHost, name, setGame]);\n\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        {!ready ? (\n          <>\n            {isHost ? (\n              <div>\n                <button\n                  onClick={() => {\n                    const freshGame = newGame({\n                      ...gameConfig,\n                      playerNames: peers,\n                    });\n                    setGame(freshGame, game.id);\n                    setReady(true);\n                  }}\n                >\n                  Start game\n                </button>\n                <GameConfigurator\n                  readOnly={false}\n                  setGameConfig={setGameConfig}\n                />\n              </div>\n            ) : (\n              (name !== \"\" || sessionId !== \"\") && (\n                <span>Wait for host to start the game</span>\n              )\n            )}\n            <div>\n              <ul>\n                {peers.map((p) => (\n                  <li key={p}>{p}</li>\n                ))}\n              </ul>\n            </div>\n            <div>\n              <input\n                type=\"text\"\n                placeholder=\"Name\"\n                disabled={\n                  connections.length > 0 || peers.length > 0 ? true : false\n                }\n                onChange={(e) => setName(e.target.value)}\n                value={name}\n              />\n            </div>\n            <hr />\n            {isHost && (\n              <div>\n                <span>\n                  Waiting for connections. Share your session ID: {sessionId}\n                </span>\n              </div>\n            )}\n            {!isHost && connections.length === 0 && (\n              <>\n                <div>\n                  <button\n                    disabled={name === \"\"}\n                    onClick={() => {\n                      const peer = new Peer();\n                      peer.on(\"open\", (id) => {\n                        console.log(\"Listening in session\", id);\n                        setIsHost(true);\n                        setPeers([name]);\n                        setSessionId(id);\n                        peer.on(\"connection\", (conn) => {\n                          console.log(\"Received connection!\", conn);\n                          setConnections((cs) => [...cs, conn]);\n                        });\n                      });\n                    }}\n                  >\n                    Host a session\n                  </button>\n                </div>\n                <span>or</span>\n                <div>\n                  <input\n                    type=\"text\"\n                    placeholder=\"Session id\"\n                    value={sessionId}\n                    onChange={(e) => setSessionId(e.target.value)}\n                  />\n                  <button\n                    disabled={sessionId === \"\" || name === \"\"}\n                    onClick={() => {\n                      console.log(\"trying to connect to\", sessionId);\n                      const peer = new Peer();\n                      peer.on(\"open\", (id) => {\n                        console.log(\"I have ID\", id);\n                        const conn = peer.connect(sessionId.trim());\n                        setConnections((cs) => [...cs, conn]);\n                      });\n                    }}\n                  >\n                    Join a session\n                  </button>\n                </div>\n              </>\n            )}\n          </>\n        ) : (\n          <>\n            {game.winner ? (\n              <>\n                <span>We have a winner! Congrats {game.winner.name}</span>\n                {isHost && (\n                  <button\n                    onClick={() => {\n                      setGame(\n                        newGame({ ...gameConfig, playerNames: peers }),\n                        game.id\n                      );\n                      setReady(true);\n                    }}\n                  >\n                    Restart Game\n                  </button>\n                )}\n              </>\n            ) : (\n              <>\n                <div style={{ display: \"flex\", flexDirection: \"column\" }}>\n                  <span>Top card</span>\n                  {<Card card={_.first(game.discard)} />}\n                </div>\n                <div style={{ display: \"flex\", flexDirection: \"column\" }}>\n                  <span>Deck - {game.deck.length} cards</span>\n                </div>\n                {colorPicker && (\n                  <div>\n                    {COLORS.map((color) => (\n                      <button\n                        style={{ backgroundColor: color }}\n                        key={color}\n                        onClick={() => {\n                          setGame(colorPicker(color), game.id);\n                          setColorPicker(undefined);\n                        }}\n                      >\n                        {color}\n                      </button>\n                    ))}\n                  </div>\n                )}\n                <div\n                  id=\"player-hands\"\n                  style={{\n                    display: \"flex\",\n                    justifyContent: \"space-between\",\n                    width: \"70%\",\n                  }}\n                >\n                  {game.players.map((player, playerIndex) => (\n                    <div\n                      key={player.name}\n                      style={{\n                        display: \"flex\",\n                        flexDirection: \"column\",\n                        padding: \"5px\",\n                      }}\n                    >\n                      <span\n                        style={{\n                          color:\n                            game.currentPlayer === playerIndex\n                              ? \"green\"\n                              : \"white\",\n                        }}\n                      >\n                        {player.name}\n                      </span>\n                      <span>{player.cards.length} cards</span>\n                      {player.name === name &&\n                        (game.currentPot.length === 0 ||\n                        game.currentPlayer !== playerIndex ? (\n                          <button\n                            disabled={game.currentPlayer !== playerIndex}\n                            onClick={() => {\n                              if (player.name === name)\n                                setGame(drawCard(game, playerIndex), game.id);\n                            }}\n                          >\n                            Draw card\n                          </button>\n                        ) : (\n                          <button\n                            onClick={() => {\n                              if (player.name === name)\n                                setGame(\n                                  acceptPunishment(game, playerIndex),\n                                  game.id\n                                );\n                            }}\n                          >\n                            Accept punishment (+{_.sum(game.currentPot)})\n                          </button>\n                        ))}\n                      {game.unclaimedUno !== undefined &&\n                      player.name === name ? (\n                        <div\n                          style={\n                            game.players[game.unclaimedUno].name === name\n                              ? {}\n                              : {\n                                  position: \"absolute\",\n                                  top: `${90 * Math.random()}%`,\n                                  left: `${90 * Math.random()}%`,\n                                }\n                          }\n                        >\n                          <button\n                            onClick={() => {\n                              setGame(\n                                claimUno(\n                                  game,\n                                  game.players.findIndex((p) => p.name === name)\n                                ),\n                                game.id\n                              );\n                            }}\n                          >\n                            {game.players[game.unclaimedUno].name === name\n                              ? \"Claim\"\n                              : \"Contest\"}{\" \"}\n                            UNO!\n                          </button>\n                        </div>\n                      ) : (\n                        <></>\n                      )}\n                      <div\n                        style={{\n                          display: \"flex\",\n                          flexDirection: \"column\",\n                          width: \"100%\",\n                          alignItems: \"stretch\",\n                          alignContent: \"stretch\",\n                          justifyContent: \"space-between\",\n                        }}\n                      >\n                        {player.cards.map((c, i) => (\n                          <div\n                            key={i}\n                            style={{\n                              margin: \"3px\",\n                              cursor:\n                                player.name === name ? \"pointer\" : \"default\",\n                            }}\n                          >\n                            <Card\n                              hidden={player.name !== name}\n                              key={i}\n                              onClick={() => {\n                                if (c.color === \"wild\") {\n                                  setColorPicker(() => (color: Color) => {\n                                    return playCardFromHand(\n                                      game,\n                                      playerIndex,\n                                      i,\n                                      color\n                                    );\n                                  });\n                                } else {\n                                  setGame(\n                                    playCardFromHand(game, playerIndex, i),\n                                    game.id\n                                  );\n                                }\n                              }}\n                              card={c}\n                            />\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </>\n            )}\n          </>\n        )}\n      </header>\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://cra.link/PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://cra.link/PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorkerRegistration from './serviceWorkerRegistration';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://cra.link/PWA\nserviceWorkerRegistration.unregister();\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}